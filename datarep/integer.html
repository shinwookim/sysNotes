<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Integers - Introduction to Systems Software</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

        <!-- MathJax -->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var html = document.querySelector('html');
            var sidebar = null;
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../intro.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="../datarep/datarep.html"><strong aria-hidden="true">2.</strong> Data Representation</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../datarep/binary.html"><strong aria-hidden="true">2.1.</strong> Binary Number System</a></li><li class="chapter-item expanded "><a href="../datarep/integer.html" class="active"><strong aria-hidden="true">2.2.</strong> Integers</a></li><li class="chapter-item expanded "><a href="../datarep/floats.html"><strong aria-hidden="true">2.3.</strong> Floating Point Numbers</a></li></ol></li><li class="chapter-item expanded "><a href="../cprog/cprog.html"><strong aria-hidden="true">3.</strong> The C Programming Language</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../cprog/syntax_i.html"><strong aria-hidden="true">3.1.</strong> The C Syntax Part I</a></li><li class="chapter-item expanded "><a href="../cprog/hello_world.html"><strong aria-hidden="true">3.2.</strong> Hello, World! C Edition</a></li><li class="chapter-item expanded "><a href="../cprog/syntax_ii.html"><strong aria-hidden="true">3.3.</strong> The C Syntax Part II</a></li></ol></li><li class="chapter-item expanded "><a href="../memory/memory.html"><strong aria-hidden="true">4.</strong> Memory Management</a></li><li class="chapter-item expanded "><a href="../x86asm.html"><strong aria-hidden="true">5.</strong> x86 Assembly</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../bufover.html"><strong aria-hidden="true">5.1.</strong> Buffer Overflow</a></li></ol></li><li class="chapter-item expanded "><a href="../proc.html"><strong aria-hidden="true">6.</strong> Processes</a></li><li class="chapter-item expanded "><a href="../virtmem.html"><strong aria-hidden="true">7.</strong> Virtual Memory</a></li><li class="chapter-item expanded "><a href="../caching.html"><strong aria-hidden="true">8.</strong> Caching</a></li><li class="chapter-item expanded "><a href="../threadsync.html"><strong aria-hidden="true">9.</strong> Threads & Synchronization</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Introduction to Systems Software</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="integer-encoding"><a class="header" href="#integer-encoding">Integer Encoding</a></h1>
<p>A computer stores information as a stream of bits (e.g., <code>0xe29884</code>). But what do those bits actually mean? For that, we need to assign an <strong>interpretation</strong> to the bit stream.</p>
<h2 id="unsigned-numbers"><a class="header" href="#unsigned-numbers">Unsigned Numbers</a></h2>
<p>One possible interpretation of a stream of bits is as an unsigned number. This is the most simple interpretation of a bit stream, and we read the number (represented in hexadecimal )as follows:</p>
<p>\[\begin{equation}
\begin{split}
\verb|0xe29884| &amp; = \verb|e| \times 16^5 + 2 \times 16^4 + 9 \times 16^3 + 8 \times 16^2 + 8 \times 16^1 + 4 \times16^0 \\
&amp; = 14 \times 16^5 + 2 \times 16^4 + 9 \times 16^3 + 8 \times 16^2 + 8 \times 16^ 1 + 4 \times 16^0 \\
&amp; = 14680064 + 131072 + 36864 + 2048 + 128 + 4 \\
&amp; = 14850180
\end{split}
\end{equation}\]</p>
<p>Similarly, if we want to convert a binary number (e.g., <code>0b1101</code>) to a decimal number, we’d apply the same process using powers of 2 instead of 16:</p>
<p>\[\begin{equation}
\begin{split}
\verb|0b1101|   &amp; = 1 \times 2^3 + 1 \times 2^2 + 0 \times 2^1 + 1 \times 2^0 \\
&amp; = 2^3 + 2^2 0 + 2^0 \\
&amp; = 8 + 4 + 0 + 1 \\
&amp; = 13
\end{split}
\end{equation}\]</p>
<h2 id="signed-numbers"><a class="header" href="#signed-numbers">Signed Numbers</a></h2>
<p>Another possible interpretation of a hex digit is as an signed number. One of the most common way of representing signed numbers using ones and zeros is called <strong>two's complement</strong>. In two's complement, the most significant bit (MSb) denotes the sign of a number. For instance, given a 3-bit number:</p>
<div class="table-wrapper"><table><thead><tr><th>Binary Representation</th><th>Value</th></tr></thead><tbody>
<tr><td><code>100</code></td><td>-4</td></tr>
<tr><td><code>101</code></td><td>-3</td></tr>
<tr><td><code>110</code></td><td>-2</td></tr>
<tr><td><code>111</code></td><td>-1</td></tr>
<tr><td><code>000</code></td><td>0</td></tr>
<tr><td><code>001</code></td><td>1</td></tr>
<tr><td><code>010</code></td><td>2</td></tr>
<tr><td><code>011</code></td><td>3</td></tr>
</tbody></table>
</div>
<p>we can see that numbers with a 1 in the left-most bit is negative, whereas numbers with a 0 in the left-most bit are positive. We can also see that there is one additional negative number than the positives. That is, \(-4\) does not have a positive counterpart. Two's complement is achieved by:</p>
<ol>
<li>Starting with the equivalent positive number.</li>
<li>Inverting (or flip) all bits – changing every 0 to 1, and every 1 to 0;</li>
<li>Adding 1 to the entire inverted number, ignoring any overflow</li>
</ol>
<p>For example, to write \(-3 \) using 4 bits:</p>
<ol>
<li>We first write the bit pattern for positive \(3 \implies \verb|0b0010|\).</li>
<li>We then flips all the bits \( \verb|0b0010| \implies \verb|0b1100|\).</li>
<li>Finally, we add 1 to get \( \verb|0b1100| + 1 \implies \verb|0b1101|\).</li>
</ol>
<p>Notice that if we apply the same process for the bit pattern of \( -3 \), we get \(\verb|0b1101| \implies \verb|0b0010| \implies \verb|0b0011| \) which is the bit pattern for positive \( 3\). That is, by applying the process above, we can negate any number in two's complement. Formally, this process can be written as:</p>
<p>\[\begin{equation}
\text{Encode}(x)
\begin{cases} 
x &amp; x\geq 0 \\
x + 2^n &amp; x &lt; 0 
\end{cases} \\
\text{Decode}(x)
\begin{cases} 
x &amp; x &lt; 2 ^{n-1} \\
x - 2^n &amp; x \geq 2 ^{n-1} 
\end{cases}
\end{equation}\]</p>
<p>Two's complement is useful since arithmetic can be done on numbers of either sign without having to do anything special.</p>
<h3 id="integer-ranges"><a class="header" href="#integer-ranges">Integer Ranges</a></h3>
<p>We saw that for \(n \)-bit unsigned numbers, the range of representable integers were \(0\) to \(2^n-1\). However, if we are using two's complement signed numbers, the range of representable integers become \(-2^{n-1}\) to \(2^{n-1} -1\) (since there is one more negative number than there are positive numbers). This also means that there is no positive counterpart to \(-2^{n-1}\). In fact, if we attempt to negate this number, we get:
\[
-(-2^{n-1})=-(\verb|0b100|\ldots\verb|0|)=\verb|0b011|\ldots\verb|1|+1=\verb|0b100|\ldots\verb|0| = -2^{n-1}
\]</p>
<h3 id="overflow"><a class="header" href="#overflow">Overflow</a></h3>
<p>We know that for \(n \)-bit signed numbers, the largest representable integer is \(2^{n-1}-1\). But, what happens when we try to add \(1\) to this number?</p>
<p>Consider \(\verb|0b0111| \), a 4-bit signed number, whose value is 7. If we try adding 1 to this number, we get:
\[
7+1=\verb|0b0111| + 1 = \verb|0b1000|=-8
\] 
This is an example of an <strong>integer overflow</strong> which occurs when an arithmetic operation attempts to create a numeric value that is outside of the range that can be represented with a given number of digits. Integer overflows can occur in either direction:</p>
<ul>
<li>When an addition produces a value that is higher than the maximum representable value.</li>
<li>When a subtraction produces a value that is lower than the minimum representable value.</li>
</ul>
<p>Integer overflows are a common source of <em>undefined behavior</em> and can often lead to bugs in programs. Hence, detecting overflow is a crucial task for programmers.</p>
<p>An overflow occurs when the value affects the sign:</p>
<ul>
<li>If adding two positive numbers yields a negative result, an overflow occurred.</li>
<li>If subtracting two negative number yields a positive result, an overflow occurred.</li>
<li>If subtracting a negative number from a positive number yields a negative result, an overflow occurred.</li>
<li>If subtracting a positive number from a negative number yields a positive result, an overflow occurred.</li>
<li>An overflow cannot occur when subtracting two numbers of the same sign.</li>
<li>An overflow cannot occur when adding two numbers of opposing signs.</li>
</ul>
<h2 id="integers-in-c"><a class="header" href="#integers-in-c">Integers in C</a></h2>
<p>In Java, integers were signed variables which used the two's complement interpretation. This meant that variables could hold values from \(-2^{n-1} \) to \(2^{n-1} -1\) where \(n\) is given by the variable type.</p>
<div class="table-wrapper"><table><thead><tr><th>Integer Types</th><th>size</th></tr></thead><tbody>
<tr><td>byte</td><td>8 bits</td></tr>
<tr><td>short</td><td>16 bits</td></tr>
<tr><td>int</td><td>32 bits</td></tr>
<tr><td>long</td><td>64 bits</td></tr>
</tbody></table>
</div>
<p>In C, variables can be declared as either signed or unsigned. This means that any variable declared as unsigned can hold values from \(0\) to \(2^n -1\) and variables declared as signed can hold values from \(-2^{n-1}\) to \(2^{n -1}-1\).<sup class="footnote-reference"><a href="#c-tc">1</a></sup></p>
<p>The \(n\), like in Java, is given by the variable type. A typical 64-bit machine will have variable sizes as such:</p>
<div class="table-wrapper"><table><thead><tr><th>Integer Types</th><th>size</th></tr></thead><tbody>
<tr><td>char</td><td>8 bits</td></tr>
<tr><td>short int</td><td>16 bits</td></tr>
<tr><td>int</td><td>32 bits</td></tr>
<tr><td>long     int</td><td>64 bits</td></tr>
</tbody></table>
</div>
<p>However, these sizes are <em>architecture-dependent</em> and can vary from machine to machine. As such, the <a href="https://pubs.opengroup.org/onlinepubs/009695399/basedefs/limits.h.html">C standard library</a> provides constants which can help define the ranges of each variables.</p>
<pre><code class="language-c">#include &lt;limits.h&gt; // for INT_MAX, UNIT_MAX
#include &lt;stdio.h&gt;  // for printf()
int main()
{
  printf(&quot;%d&quot;, INT_MAX); // prints 2147483647
  printf(&quot;%d&quot;, UINT_MAX); // prints 4294967295
  return 0;
}
</code></pre>
<p>Additionally, the <code>sizeof</code> operator (built in to C) allows us the ability to programmatically obtain the byte size of data.</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;  // for printf()
int main()
{
  printf(&quot;%d&quot;, sizeof(int));       // prints 4 (= 32b) on a typical 64-bit machine
  long long_var = 0;
  printf(&quot;%d&quot;, sizeof(long_var));  // prints 8 (= 64b) on a typical 64-bit machine
  return 0;
}
</code></pre>
<h3 id="integer-casting"><a class="header" href="#integer-casting">Integer Casting</a></h3>
<p>In C, like in many other programming languages, we can cast<sup class="footnote-reference"><a href="#cast">2</a></sup> variables to another type. In addition, C lets us move a value from an unsigned integer variable to a signed integer variable (and vice versa).</p>
<pre><code class="language-c">int sx, sy;
unsigned ux, uy;
sx = (int) ux;
uy = (unsigned) sy;
</code></pre>
<p>When we cast a variable from signed to unsigned (or unsigned to signed), the underlying bit pattern is not changed, but the interpretation of the bit pattern is. This becomes troublesome when a cast results in a interpretation that is not valid. Even if the resulting interpretation is invalid, your program will still cast anyway. This is called <strong>coercion</strong>.</p>
<pre><code class="language-c">#include &lt;stdio.h&gt;
#include &lt;limits.h&gt;
int main()
{
    int i = -1;
    unsigned u = (unsigned) i;
    printf(&quot;i=%d, u=%u\n&quot;, i, u);
    return 0;
} // Output: i=-1, u=4294967295
</code></pre>
<p>Since C ignore the obvious invalid operations this is sometimes referred to as &quot;weak&quot; typing.<sup class="footnote-reference"><a href="#weak-typing">3</a></sup></p>
<p>In addition to the explicit casts (like the one above), we can also <em>implicitly</em> cast between variables through assignments and procedure calls:</p>
<pre><code class="language-c">sx = ux;
uy= sy;
int (fun unsigned u);
uy = fun(sx);
</code></pre>
<p>By default, integer literals (constants) are considered to be <em>signed integers</em>. If we were to explicitly force them to be unsigned, we can suffix a &quot;<code>U</code>&quot; or &quot;<code>u</code>&quot; to the literal like: <code>0U</code>, <code>4294967259u</code>.</p>
<p>Lastly, when we mix an unsigned and signed variable in a single expression (including comparison operators), signed values are implicitly cast to unsigned values.</p>
<hr />
<p><sup class="footnote-reference"><a href="#c-tc">1</a></sup> Two's complement is not strictly mandated by the C language. However, most machines use it to store and represent signed integers.</p>
<p><sup class="footnote-reference"><a href="#cast">2</a></sup> Moving values between different type is called <strong>casting</strong>.</p>
<p><sup class="footnote-reference"><a href="#weak-typing">3</a></sup> The strong/weak terminology has had very fragile definitions over the years and are arguably useless in our context. Hence, we will ignore them.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../datarep/binary.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next" href="../datarep/floats.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../datarep/binary.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next" href="../datarep/floats.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->
        <script src="../mermaid.min.js"></script>
        <script src="../mermaid-init.js"></script>


    </div>
    </body>
</html>
